<!--
 ______________
< yilishan >
 --------------
        \   ^__^
         \  (**)\__$__$__
            (__)\       )\/\
             U  ||------|
                ||     ||
-->
<!DOCTYPE html>
<html lang="en">
<head>
</head>
<body>
<div id="time">

</div>
<!--游戏面板-->
<div id="main_panel" style="width:44px;height:47px;position:absolute;top:400px;left:20px;background-image:url('res/img/dragon.png');">

</div>
<script>
    var speed_h=10;
    var speed_s=10;
    onkeydown=function(event){
        if(event.keyCode==13){
//            document.getElementById("main_panel").innerHTML="回车"+event.keyCode;
        }
        //上
        if(event.keyCode==38){
            var mydate=new Date();
            document.getElementById("time").innerHTML="上"+mydate.getTime();
            document.getElementById("main_panel").style.top=(document.getElementById("main_panel").getBoundingClientRect().top-speed_s)+"px";
        }
        //下
        if(event.keyCode==40){
//            document.getElementById("main_panel").innerHTML="下"+event.keyCode;
            document.getElementById("main_panel").style.top=(document.getElementById("main_panel").getBoundingClientRect().top+speed_s)+"px";
        }
        //左
        if(event.keyCode==37){
//            document.getElementById("main_panel").innerHTML="左"+event.keyCode;
            document.getElementById("main_panel").style.left=(document.getElementById("main_panel").getBoundingClientRect().left-speed_h)+"px";
        }
        //右
        if(event.keyCode==39){
//            document.getElementById("main_panel").innerHTML="右"+event.keyCode;
            document.getElementById("main_panel").style.left=(document.getElementById("main_panel").getBoundingClientRect().left+speed_h)+"px";
        }

    }

//    抛体运动，输入起始top值，初始速度值，重力值，经历的时间，返回当前top值
    function top_now(top0,v0,g,deta_t){
        var top_now=top0;
        var deta_h=v0*deta_t-0.5*g*deta_t*deta_t;
        top_now=top0-deta_h;
        document.getElementById("time").innerHTML="top0="+top0+"<br>top_now="+top_now+"<br>deta_h="+deta_h+"<br>deta_t="+deta_t;
        return top_now;
    }

    var top0=document.getElementById("main_panel").getBoundingClientRect().top;
    var i=0;
    var v0=10;
    var g=0.2;
    function go(){
        if(i==1000){
            i=0;
        }
        i++;
        if(top_now(top0,v0,g,i)>=top0){
            i=0;
        }   
        document.getElementById("main_panel").style.top=top_now(top0,v0,g,i)+"px";

        setTimeout('go()',10);//定时器
    }
    go();

</script>
</body>
<head>
    <meta charset="UTF-8">
    <title>Run!</title>
</head>
</html>